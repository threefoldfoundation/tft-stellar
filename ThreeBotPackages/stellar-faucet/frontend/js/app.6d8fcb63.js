(function(e){function t(t){for(var r,c,i=t[0],s=t[1],u=t[2],l=0,p=[];l<i.length;l++)c=i[l],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&p.push(a[c][0]),a[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);d&&d(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},o=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var d=s;o.push([1,"chunk-vendors"]),n()})({0:function(e,t){},1:function(e,t,n){e.exports=n("56d7")},2:function(e,t){},3:function(e,t){},"3e1d":function(e,t,n){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e623"),n("e379"),n("5dc8"),n("37e1");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-content",{attrs:{"fill-height":""}},[n("v-layout",{attrs:{"justify-center":"","fill-height":""}},[n("v-layout",{attrs:{column:"","align-center":"","justify-center":""}},[n("router-view")],1)],1)],1)],1)},o=[],c={name:"App"},i=c,s=n("2877"),u=n("6544"),d=n.n(u),l=n("7496"),p=n("a75b"),f=n("a722"),h=Object(s["a"])(i,a,o,!1,null,null,null),v=h.exports;d()(h,{VApp:l["a"],VContent:p["a"],VLayout:f["a"]});var m=n("f309"),b=n("fcf4");r["a"].use(m["a"]);var g,y,w=new m["a"]({theme:{dark:!0,themes:{dark:{primary:b["a"].purple.accent4}}}}),_=n("a65d"),O=n.n(_),j=n("8c4f"),x=(n("99af"),n("96cf"),n("1da1")),k={botFrontEnd:"https://login.threefold.me",botBackend:"https://login.threefold.me/",redirect_url:"/callback",appId:window.location.host,seedPhrase:"weather smooth little world side palace green armor busy view solution escape"},S=(n("d3b7"),n("427a")),T=n("7dee"),A=n("29c9"),B={validateSignature:function(e,t,n){return new Promise(function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,T.ready;case 2:n=Object(S["decodeBase64"])(n),t=Object(S["decodeBase64"])(t),a=T.crypto_sign_open(t,n),r(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},decrypt:function(e,t,n,r){return new Promise(function(){var a=Object(x["a"])(regeneratorRuntime.mark((function a(o){var c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e=Object(S["decodeBase64"])(e),a.next=3,T.ready;case 3:n=T.crypto_sign_ed25519_sk_to_curve25519(Object(S["decodeBase64"])(n)),r=T.crypto_sign_ed25519_pk_to_curve25519(Object(S["decodeBase64"])(r)),t=Object(S["decodeBase64"])(t),c=T.crypto_box_open_easy(e,t,r,n),c=Object(S["encodeUTF8"])(c),o(c);case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},validateSignedAttempt:function(e,t){return new Promise(function(){var n=Object(x["a"])(regeneratorRuntime.mark((function n(r,a){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,T.ready;case 2:t=Object(S["decodeBase64"])(t),e=Object(S["decodeBase64"])(e),o=T.crypto_sign_open(e,t),o||a("Invalid signature."),r(o);case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},encrypt:function(e,t,n){return new Promise(function(){var r=Object(x["a"])(regeneratorRuntime.mark((function r(a){var o,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e=(new TextEncoder).encode(e),r.next=3,T.ready;case 3:t=T.crypto_sign_ed25519_sk_to_curve25519(Object(S["decodeBase64"])(t)),n=T.crypto_sign_ed25519_pk_to_curve25519(Object(S["decodeBase64"])(n)),o=T.randombytes_buf(T.crypto_secretbox_NONCEBYTES),c=T.crypto_box_easy(e,o,n,t),a({encrypted:Object(S["encodeBase64"])(c),nonce:Object(S["encodeBase64"])(o)});case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},generateKeys:function(e){return new Promise(function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(n){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,T.ready;case 2:e||(e=A.entropyToMnemonic(T.randombytes_buf(T.crypto_box_SEEDBYTES/2))),r=(new TextEncoder).encode(A.mnemonicToEntropy(e)),a=T.crypto_sign_seed_keypair(r),n({phrase:e,privateKey:Object(S["encodeBase64"])(a.privateKey),publicKey:Object(S["encodeBase64"])(a.publicKey)});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getEdPkInCurve:function(e){return Object(S["encodeBase64"])(T.crypto_sign_ed25519_pk_to_curve25519(Object(S["decodeBase64"])(e)))}},C=n("4487"),P={name:"login",data:function(){return{privateKey:null,publicKey:null,privateKey2:null,publicKey2:null,message:null,encrypted:null,decrypted:null,nonce:null}},mounted:function(){this.login()},methods:{login:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=C.generate(),window.localStorage.setItem("state",t),e.next=4,B.generateKeys(k.seedPhrase);case 4:n=e.sent,r=k.appId,window.location.href="".concat(k.botFrontEnd,"?state=").concat(t,"&appid=").concat(r,"&publickey=").concat(encodeURIComponent(B.getEdPkInCurve(n.publicKey)),"&redirecturl=").concat(encodeURIComponent(k.redirect_url));case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),redirect:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(t,n,r,a,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.location.href="".concat(k.botFrontEnd,"?state=").concat(t,"&scope=").concat(n,"&appid=").concat(r,"&publickey=").concat(encodeURIComponent(B.getEdPkInCurve(a)),"&redirecturl=").concat(encodeURIComponent(o));case 1:case"end":return e.stop()}}),e)})));function t(t,n,r,a,o){return e.apply(this,arguments)}return t}()}},R=P,E=Object(s["a"])(R,g,y,!1,null,null,null),V=E.exports,I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"inspire"}},[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"10",sm:"12",md:"6"}},[n("h1",[e._v("Stellar Faucet")]),n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[e._v("Fund a Stellar address")])],1),n("v-card-text",[n("v-form",{on:{submit:function(t){return t.preventDefault(),e.fundAddress(t)}}},[n("v-text-field",{attrs:{required:"",placeholder:"Address"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}}),e.error?n("p",{attrs:{id:"errortext"}},[e._v("This address probably does not exist or does not have a trustline with the issuer of our Stellar TFT (Testnet).")]):e._e()],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{staticClass:"ma-2",attrs:{color:"primary",loading:e.loading,disabled:e.loading||""===e.address},on:{click:function(t){return e.fundAddress()}}},[e._v(" Fund ")])],1)],1)],1)],1)],1)],1)},K=[],F=n("bc3a"),N=n.n(F);function U(e,t,n){return N.a.post("http://localhost/threefoldfoundation/stellar_faucet/actors/stellar_faucet/transfer",{args:{destination:e,username:t,signed_hash:n}})}function M(e){return N.a.get("".concat(k.botBackend,"/api/users/").concat(e))}var J={data(){return{error:!1,address:"",loading:!1,verifiedSignedAttempt:void 0,username:void 0}},async mounted(){let e=new URL(window.location.href),t=e.searchParams.get("error");if(t)return void console.log("Error: ",t);let n=JSON.parse(e.searchParams.get("signedAttempt")),r=n["doubleName"];this.username=r;let a,o=(await M(r)).data.publicKey;try{var c=function(){var e=new Array(128),t=String.fromCodePoint||String.fromCharCode,n=[];return function(r){var a,o,c=r.length;n.length=0;for(var i=0;i<c;)o=r[i++],o<=127?a=o:o<=223?a=(31&o)<<6|63&r[i++]:o<=239?a=(15&o)<<12|(63&r[i++])<<6|63&r[i++]:String.fromCodePoint?a=(7&o)<<18|(63&r[i++])<<12|(63&r[i++])<<6|63&r[i++]:(a=63,i+=3),n.push(e[a]||(e[a]=t(a)));return n.join("")}}();if(a=JSON.parse(c(await B.validateSignedAttempt(n["signedAttempt"],o))),!a)return void console.log("The signedAttempt could not be verified.");let e=window.localStorage.getItem("state");if(a["signedState"]!==e)return void console.log("The state cannot be matched.");if(a["doubleName"]!==r)return void console.log("The name cannot be matched.");this.verifiedSignedAttempt=a}catch(i){return void console.log("The signedAttempt could not be verified.")}},methods:{fundAddress(){this.loading=!0,this.error=!1,console.log(this.verifiedSignedAttempt),U(this.address,this.username,this.verifiedSignedAttempt.signedState).then(e=>{200==e.status?(this.loading=!1,this.$toasted.success("Address funded successfully")):this.error=!0}).catch(()=>{this.error=!0,this.loading=!1})}},name:"FundAccount"},$=J,D=(n("e4ce"),n("8336")),L=n("b0af"),Y=n("99d9"),q=n("62ad"),z=n("a523"),G=n("4bd4"),H=n("0fd9b"),Q=n("2fa4"),W=n("8654"),X=n("71d9"),Z=n("2a7f"),ee=Object(s["a"])($,I,K,!1,null,"0e05aff0",null),te=ee.exports;d()(ee,{VApp:l["a"],VBtn:D["a"],VCard:L["a"],VCardActions:Y["a"],VCardText:Y["b"],VCol:q["a"],VContainer:z["a"],VForm:G["a"],VRow:H["a"],VSpacer:Q["a"],VTextField:W["a"],VToolbar:X["a"],VToolbarTitle:Z["a"]}),r["a"].use(j["a"]);var ne=new j["a"]({mode:"history",base:"",routes:[{path:"/",name:"login",component:V},{path:"/callback",name:"callback",component:te}]});r["a"].config.productionTip=!1,r["a"].use(O.a,{duration:3e3,theme:"bubble",position:"bottom-center"}),new r["a"]({vuetify:w,router:ne,render:function(e){return e(v)}}).$mount("#app")},e4ce:function(e,t,n){"use strict";var r=n("3e1d"),a=n.n(r);a.a}});
//# sourceMappingURL=app.6d8fcb63.js.map